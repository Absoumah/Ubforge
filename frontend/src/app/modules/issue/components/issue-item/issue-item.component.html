<div class="issue-item" (click)="onIssueClick()">
    <div class="issue-header">
        <div class="issue-title">
            <h3>{{ issue.title }}</h3>
            <span class="category-badge">{{ issue.category }}</span>
        </div>
        <div class="issue-dates">
            <span>Reported: {{ issue.reportedDate | date: 'shortDate' }}</span>
            <span>Due: {{ issue.dueDate | date: 'shortDate' }}</span>
        </div>
    </div>

    <p class="issue-description">{{ issue.description }}</p>

    <div class="issue-tasks">
        <div class="tasks-header">
            <div class="tasks-navigation">
                <h4>Tasks ({{ getCompletedTasksCount() }}/{{ issue.tasks.length }})</h4>
                <div class="navigation-controls" *ngIf="issue.tasks.length > 0">
                    <button class="nav-button" [class.disabled]="!canGoBack"
                        (click)="$event.stopPropagation(); onPrevTask()">◀</button>
                    <span class="task-count">Task {{ currentTaskIndex + 1 }} of {{ issue.tasks.length }}</span>
                    <button class="nav-button" [class.disabled]="!canGoForward"
                        (click)="$event.stopPropagation(); onNextTask()">▶</button>
                </div>
            </div>
        </div>
        <app-task-item *ngIf="issue.tasks.length > 0" [task]="issue.tasks[currentTaskIndex]"
            (statusChange)="onTaskStatusChange($event)">
        </app-task-item>
    </div>

    <div class="issue-actions">
        <button class="edit-button" (click)="$event.stopPropagation(); edit.emit(issue.id)"></button>
        <button class="delete-button" (click)="$event.stopPropagation(); delete.emit(issue.id)"></button>
    </div>
</div>